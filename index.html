<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Personal Finance & Expense Tracker</title>

    <!-- ðŸ” Protect page -->
    <script>
        if (!localStorage.getItem("token")) {
            window.location.href = "login.html";
        }
    </script>

    <!-- CSS -->
    <link rel="stylesheet" href="style.css">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <div class="container">

        <!-- HEADER -->
        <header>
            <h1>ðŸ’° Personal Finance Tracker</h1>
            <p>Track income, expenses & monthly spending</p>

            <div style="margin-top:10px;">
                <span id="welcome-user"></span>
                <button onclick="logout()">Logout</button>
            </div>
        </header>

        <!-- BALANCE -->
        <section class="balance">
            <h2>Current Balance</h2>
            <h1>â‚¹ <span id="balance">0</span></h1>
        </section>

        <!-- INCOME & EXPENSE SUMMARY -->
        <section class="summary">
            <div class="card income">
                <h3>Total Income</h3>
                <p>â‚¹ <span id="total-income">0</span></p>
            </div>

            <div class="card expense">
                <h3>Total Expense</h3>
                <p>â‚¹ <span id="total-expense">0</span></p>
            </div>
        </section>

        <!-- DASHBOARD -->
        <section class="dashboard">

            <!-- LEFT SIDE -->
            <div class="transaction-boxes">

                <!-- INCOME -->
                <div class="box income-box">
                    <h3>âž• Income</h3>
                    <button type="button" id="show-income">Add Income</button>

                    <div id="income-form" class="hidden">
                        <form id="add-income-form">

                            <label>Income Type</label>
                            <select id="income-type">
                                <option value="Active">Active</option>
                                <option value="Passive">Passive</option>
                            </select>

                            <label>Amount</label>
                            <input type="number" id="income-amount" step="500" min="0"
                                placeholder="Enter amount (â‚¹500 steps)" required>

                            <label>Date</label>
                            <input type="date" id="income-date" required>

                            <button type="submit">Add Income</button>
                        </form>
                    </div>
                </div>

                <!-- EXPENSE -->
                <div class="box expense-box">
                    <h3>âž– Expense</h3>
                    <button type="button" id="show-expense">Add Expense</button>

                    <div id="expense-form" class="hidden">
                        <form id="add-expense-form">

                            <label>Expense Type</label>
                            <select id="expense-category">
                                <option value="Food">Food</option>
                                <option value="Rent">Rent</option>
                                <option value="Travel">Travel</option>
                                <option value="Shopping">Shopping</option>
                                <option value="Bills">Bills</option>
                                <option value="Other">Other</option>
                            </select>

                            <label>Amount</label>
                            <input type="number" id="expense-amount" step="500" min="0"
                                placeholder="Enter amount (â‚¹500 steps)" required>

                            <label>Date</label>
                            <input type="date" id="expense-date" required>

                            <label>Note (Optional)</label>
                            <input type="text" id="expense-note">

                            <button type="submit">Add Expense</button>
                        </form>
                    </div>
                </div>

            </div>

            <!-- RIGHT SIDE CHARTS -->
            <div class="chart">
                <h3>Income vs Expense</h3>
                <canvas id="incomeExpenseChart"></canvas>

                <h3 style="margin-top: 30px;">Expense by Category</h3>
                <canvas id="categoryExpenseChart"></canvas>
            </div>

        </section>

        <!-- TRANSACTION HISTORY -->
        <section class="history">
            <h3>Transaction History</h3>
            <ul id="transaction-list"></ul>
        </section>

        <!-- MONTHLY SUMMARY -->
        <section class="monthly-summary">
            <h3>Monthly Summary</h3>

            <select id="month-filter"></select>

            <div class="summary-result">
                <p>Total Income: â‚¹ <span id="monthly-income">0</span></p>
                <p>Total Expense: â‚¹ <span id="monthly-expense">0</span></p>
            </div>
        </section>

        <!-- RESET -->
        <div class="reset-section">
            <button id="reset-data">Reset All Data</button>
        </div>

    </div>

    <!-- ðŸ‘¤ Welcome name + Logout -->
    <script>
        const name = localStorage.getItem("name");
        if (name) {
            document.getElementById("welcome-user").innerText = "Welcome, " + name;
        }

        function logout() {
            localStorage.clear();
            window.location.href = "login.html";
        }
    </script>

    <!-- Main JS -->
    <script src="script.js"></script>

</body>
</html>
